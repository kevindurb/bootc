FROM ghcr.io/ublue-os/bazzite-deck:41

RUN dnf install -y snapd && \
  dnf clean all && \
  systemctl enable snapd.service && \
  /usr/bin/ln -sf /var/lib/snapd/snap /

RUN dnf install -y \
  dnf5-plugins \
  dialog \
  edk2-ovmf \
  edk2-tools \
  genisoimage \
  krdp \
  libvirt \
  mesa-demos \
  nmap-ncat \
  qemu \
  qemu-ui-sdl \
  spice-gtk-tools \
  swtpm \
  virt-manager \
  gstreamer1-plugin-libav \
  gstreamer1-plugin-openh264 \
  gstreamer1-plugins-base \
  gstreamer1-plugins-good \
  heif-pixbuf-loader && \
  dnf clean all

RUN dnf install -y syncthing && \
  dnf clean all && \
  systemctl --global enable syncthing.service

COPY ./scripts/dev-packages-install.sh /tmp
RUN /tmp/dev-packages-install.sh
