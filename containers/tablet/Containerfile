ARG FEDORA_MAJOR_VERSION=rawhide
FROM ghcr.io/kevindurb/gnome-bootc:${FEDORA_MAJOR_VERSION}

RUN sudo dnf config-manager \
  addrepo --from-repofile=https://pkg.surfacelinux.com/fedora/linux-surface.repo

RUN dnf install -y --allowerasing \
  kernel-surface \
  iptsd \
  libwacom-surface \
  surface-secureboot

RUN mkdir /tmp/scripts

COPY ./scripts/snapd-install.sh /tmp/scripts
RUN /tmp/scripts/snapd-install.sh

COPY ./scripts/tailscale-install.sh /tmp/scripts
RUN /tmp/scripts/tailscale-install.sh

COPY ./scripts/codecs-install.sh /tmp/scripts
RUN /tmp/scripts/codecs-install.sh

COPY ./scripts/base-packages-install.sh /tmp/scripts
RUN /tmp/scripts/base-packages-install.sh

COPY ./scripts/gnome-extensions-install.sh /tmp/scripts
RUN /tmp/scripts/gnome-extensions-install.sh

COPY ./scripts/chezmoi-install.sh /tmp/scripts
RUN /tmp/scripts/chezmoi-install.sh

COPY ./scripts/syncthing-install.sh /tmp/scripts
RUN /tmp/scripts/syncthing-install.sh

COPY ./scripts/dev-packages-install.sh /tmp/scripts
RUN /tmp/scripts/dev-packages-install.sh
