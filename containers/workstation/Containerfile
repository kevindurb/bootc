ARG FEDORA_MAJOR_VERSION
FROM quay.io/fedora/fedora-kinoite:${FEDORA_MAJOR_VERSION}

RUN dnf install -y snapd && \
  dnf clean all && \
  systemctl enable snapd.service && \
  /usr/bin/ln -sf /var/lib/snapd/snap /

RUN dnf install -y tailscale && \
  dnf clean all && \
  systemctl enable tailscaled.service

COPY ./packages/codecs.packages /tmp
RUN dnf install -y $(cat /tmp/codecs.packages) && \
  dnf clean all

RUN dnf remove -y \
  firefox \
  firefox-langpacks && \
  dnf clean all

RUN dnf install -y syncthing && \
  dnf clean all && \
  systemctl --global enable syncthing.service

ADD https://openrgb.org/releases/release_0.9/60-openrgb.rules /usr/lib/udev/rules.d/

COPY ./packages/dev.packages /tmp
RUN dnf5 copr enable -y atim/lazygit && \
  dnf5 copr enable -y atim/starship && \
  dnf5 install -y $(cat /tmp/dev.packages) && \
  dnf5 clean all
